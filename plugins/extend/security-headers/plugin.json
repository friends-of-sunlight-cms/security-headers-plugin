{
    "$schema": "../../../system/schema/extend.json",
    "name": "Security Headers",
    "description": "Adds additional security headers",
    "version": "1.0.0",
    "environment": {
        "system": "^8.3.0"
    },
    "authors": [
        {"name": "Friends of Sunlight CMS", "url": "https://github.com/friends-of-sunlight-cms/"}
    ],
    "langs": {
       "security-headers": "lang"
    },
    "actions": {
        "config": "ConfigAction"
    },
    "config_defaults": {
        "strict_transport_security_enabled": true,
        "strict_transport_security_max_age": 31536000,
        "strict_transport_security_include_subdomains": true,
        "strict_transport_security_preload": false,
        "content_security_policy_enabled": false,
        "content_security_policy": {
            "default-src": "'self'",
            "script-src": "'self'",
            "style-src": "'self' 'unsafe-inline'",
            "img-src": "'self' data:",
            "font-src": "'self'",
            "connect-src": "'self'",
            "media-src": "'self'",
            "frame-src": "'none'",
            "object-src": "'none'",
            "frame-ancestors": "'none'",
            "base-uri": "'self'",
            "form-action": "'self'"
        },
        "x_frame_options_enabled": true,
        "x_frame_options": "SAMEORIGIN",
        "x_content_type_options_enabled": false,
        "referrer_policy_enabled": false,
        "referrer_policy": "strict-origin-when-cross-origin",
        "permissions_policy_enabled": true,
        "permissions_policy": {
            "geolocation": "()",
            "microphone": "()",
            "camera": "()",
            "fullscreen": "self"
        }
    },
    "events": [
        {"event": "core.ready", "script": "event/core_ready.php"}
    ]
}